---
title: "x41414141 CTF Writeup"
date: 2020-12-20 00:05:00 -0800
categories: [CTF, writeup]
tags: [writeup, web]
toc: true
---

> Blockchain-focused CTF, hosted by Offshift

## Introduction

x41414141 CTF is sponsored by Offshift, and the challenge creators are the mods from John Hammond's Discord server. I played with IrisSec.

## Pin Code (Entry Challenge)

On the main page of the CTF, there is a GIF with Offshift (the sponsor)'s logo. Downloading the GIF, I run strings on it. There is one string with the word "Secret" followed by a binary string.

I take the binary number and convert it to decimal, and I can use it as a pin for the website.

## File Reader (77 Solves)

> hello guys, I started this new service check note.txt file for a sanity check 207.180.200.166 2324

It asks me for a file to read, and I want to read /flag.txt.

They filtered out the word ``flag`` when reading files. I could bypass this using the ? wildcard character, or by using *. 

Potential Solutions

```
/????.txt
/????.???
/fl*.txt
```

## SH Jail (36 Solves)

We get source code, showing off a filter and showing that flag.txt was marked as 555, or readable and executable.

Using this, we can bypass the filter to "run" the text file in bash and it will show the "command" or the line/flag in the file.

When we bypass the filter, our output is executed. So we can do something like this:

```
. flag.[a-z][a-z][a-z]
```

This will leak the flag:

```
flag.txt: line 1: flag{w3ll_th1s_f1l3_sh0uldnt_h4v3_fl4g_1n_2738372131}: command not found
[0;32mThe command has been executed. Let's go again![0m
```

> flag{w3ll_th1s_f1l3_sh0uldnt_h4v3_fl4g_1n_2738372131}






